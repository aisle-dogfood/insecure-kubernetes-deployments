#!/bin/bash

# Exit on error
set -e

# Build the Docker image
#echo "Building SSH exploit Docker image..."
#docker build -t confusedcrib/ssh-exploit:latest -f exploit.Dockerfile .

# Push the Docker image
#echo "Pushing SSH exploit Docker image..."
#docker push confusedcrib/ssh-exploit:latest

# Delete existing pod to force restart
echo "Deleting existing pod to force restart..."
kubectl delete pod -l app=ssh-exploit --force --grace-period=0 -n erlang || true

# Deploy to Kubernetes
echo "Deploying SSH exploit to Kubernetes..."
kubectl apply -f exploit-deployment.yaml -n erlang

echo "Deployment complete! Check the status with: kubectl get pods -l app=ssh-exploit" 