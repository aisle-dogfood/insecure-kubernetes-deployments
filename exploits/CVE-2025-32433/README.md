# CVE-2025-32433: Erlang SSH Pre-Auth RCE Exploit

This exploit targets a pre-authentication remote code execution vulnerability in the Erlang SSH server implementation. It allows attackers to execute arbitrary Erlang code without authentication.

## Exploitation Steps

1. Create the Erlang namespace in your Kubernetes cluster:
   ```bash
   kubectl create namespace erlang
   ```

2. Deploy the vulnerable SSH server:
   ```bash
   cd ssh_server
   ./deploy.sh
   ```

3. Deploy the exploit that runs hourly:
   ```bash
   cd ssh_exploit
   ./deploy.sh
   ```

4. View the exfiltrated data:
   ```bash
   # List the exploit pod
   kubectl get pods -n erlang -l app=ssh-exploit
   
   # Check exploit logs to see if data was captured
   kubectl logs -n erlang -l app=ssh-exploit
   
   # Examine captured files in the pod
   kubectl exec -it $(kubectl get pod -n erlang -l app=ssh-exploit -o name) -n erlang -- ls -la /app/captured_data
   
   # Read a specific captured file
   kubectl exec -it $(kubectl get pod -n erlang -l app=ssh-exploit -o name) -n erlang -- cat /app/captured_data/env_vars_*.txt
   ```

## Exploit Details

The exploit performs the following actions:

1. Discovers the SSH server service in the Kubernetes cluster
2. Establishes a connection to the vulnerable server
3. Sends specially crafted SSH packets to trigger the vulnerability
4. Executes Erlang code that:
   - Collects environment variables
   - Reads sensitive files like /etc/passwd, /etc/shadow
   - Searches for SSH keys
   - Gathers basic host information
5. Exfiltrates the data to the listener running in the exploit pod
6. Saves the data to the `/app/captured_data` directory

The exploit runs hourly from a deployment in the same cluster, demonstrating how an attacker could maintain persistent access and regularly extract sensitive information.

## Components

- **ssh_server/**: Contains the vulnerable SSH server deployment
- **ssh_exploit/**: Contains the exploit code and deployment
  - `CVE-2025-32433.py`: The main exploit script
  - `listener.py`: TCP listener that receives exfiltrated data
  - `exploit-deployment.yaml`: Kubernetes deployment for the exploit