# CVE-2025-32433 SSH Server Exploit

Exploits pre-authentication RCE vulnerability in Erlang SSH server.

## Enhanced Environment Variable Exfiltration

This exploit has been enhanced to not only write environment variables to a file on the vulnerable server but also to exfiltrate them back to the attacker's machine via a TCP callback.

### How It Works

1. **Listener Component (`listener.py`)**:
   - Runs a TCP server on port 8080
   - Listens for incoming connections from the exploited SSH server
   - Saves received environment variables to timestamped files in `captured_data/`
   - Displays the captured data in the console

2. **Exploit Component (`CVE-2025-32433.py`)**:
   - Exploits the vulnerability in the SSH server
   - Injects Erlang code that:
     - Collects environment variables
     - Opens a connection back to the attacker
     - Sends the collected data
     - Also writes the data to a file on the server as a backup

3. **Deployment (`exploit-deployment.yaml`)**:
   - Sets up necessary RBAC permissions
   - Creates a service account
   - Exposes a service for the callback
   - Deploys a pod that runs both the listener and exploit components
   - Runs the exploit hourly while keeping the listener active

### Usage

```bash
# Deploy the exploit
kubectl apply -f exploit-deployment.yaml

# Check logs to see if environment variables were captured
kubectl logs -n erlang deploy/ssh-exploit

# If successful, you'll see captured environment variables in the logs
# and in the captured_data/ directory inside the pod
```

### Configuring Callback

By default, the exploit will use the pod's IP address for the callback. This is automatically configured using the Kubernetes Downward API. You can override this behavior by setting the `CALLBACK_HOST` environment variable to a different value.